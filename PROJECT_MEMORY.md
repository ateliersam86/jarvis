# Project Memory - Jarvis AI Nexus

## Project Overview
**Name:** Jarvis AI Nexus  
**Type:** Multi-AI Orchestration Platform  
**Architecture:** Swarm-based with Redis Pub/Sub  
**Deployment:** Docker Compose on Server Server  

## Tech Stack
- **Frontend:** Next.js 15, React 19, TypeScript, Tailwind CSS
- **Backend:** Node.js workers, Redis, Prisma (SQLite)
- **AI Models:** Gemini, Claude, ChatGPT (via Cloud Code Proxy + API Keys)
- **Orchestration:** Antigravity Opus 4.5, Gemini CLI, Codex CLI

## Current State
- ‚úÖ Gemini Worker: Online (via API Key)
- ‚úÖ ChatGPT Worker: Online (via API Key)
- ‚ö†Ô∏è Claude Worker: Offline (needs ANTHROPIC_API_KEY)
- ‚úÖ Magic Auth: Google Cloud Code Proxy configured
- ‚úÖ Masterscript: Intelligent task delegation implemented
- ‚úÖ Auto-Healer: Automatic error detection (ready to test)

## Architecture Patterns
### Swarm Communication
- Workers subscribe to `jarvis:jobs:<WORKER_TYPE>`
- Responses published to `jarvis:response:<requestId>`
- Events/logs to `jarvis:events`

### Hybrid Authentication
1. Try Google Cloud Code Proxy (Magic Auth) first
2. Fallback to individual API keys
3. Report `WAITING_FOR_AUTH` if both fail

### Task Delegation (Masterscript)
- **Gemini CLI:** Lint, type errors, documentation
- **Codex CLI:** Tests, commits, prototypes
- **Opus 4.5:** Architecture, complex refactoring

## Known Issues
1. Claude worker requires `ANTHROPIC_API_KEY` (Google Proxy doesn't support Anthropic)
2. Gemini model ID must be `gemini-1.5-flash` (not `gemini-1.5-flash-001`)
3. Database permissions on Server require `chmod 777 web/prisma/`

## Development Workflow
1. Code locally on Mac
2. Auto-healer detects errors automatically
3. Delegates to appropriate CLI (Gemini/Codex/Claude)
4. Sync to Server via `./sync.sh`
5. Workers on Server process tasks via Redis

## üß† AI Consultation Workflow (MANDATORY)
**Before implementing any significant decision/feature:**
1. **Consult 2+ AIs** with the idea (Gemini + Claude or ChatGPT)
2. **Ask them to improve** the idea and catch edge cases
3. **Verify understanding** - make sure they understood correctly
4. **Take best ideas** from each response
5. **Then code** with the refined approach

**Model Assignment (from `.config/models.yaml`):**
| Task Type | Model | Reason |
|-----------|-------|--------|
| Lint, Docs, Explain | Gemini Flash | Free, fast |
| Tests, Features | OpenAI Codex | Balanced |
| Architecture, Debug, Critical | Claude Opus | High intelligence |

## Multi-Machine Setup
- **Source of Truth:** Server server (`${JARVIS_SERVER_IP}`)
- **Shared Memory:** This file + `.conductor/state.json`
- **Sync:** `./pull.sh` on new machines

## Important Paths
- **Server:** `/mnt/user/websites/jarvis-nexus`
- **Local:** `/Users/your-username/Jarvis`
- **Redis:** `redis://jarvis-redis:6379`
- **Dashboard:** `https://jarvis.atelier-sam.fr`

## Next Steps
- [ ] Add `ANTHROPIC_API_KEY` to bring Claude online
- [ ] Test auto-healer in watch mode
- [ ] Install context7/conductor extension
- [ ] Integrate Conductor state tracking

## Strategic Roadmap (AI Brainstorm)
*Generated by ChatGPT 5.2 & Gemini 3 - To be implemented in Phase 16*

| Priority | Feature | Impact | Effort | Status |
| :--- | :--- | :--- | :--- | :--- |
| **P0** | **Approval Workflow** (Manual validation for critical commits) | 5 | 3 | üü° In Progress |
| **P0** | **File Collision Alerts** (Detect multiple agents on same file) | 5 | 2 | üî¥ Todo |
| **P1** | **Conversation Multi-turn** (Not just input/output) | 5 | 4 | üî¥ Todo |
| **P1** | **Cost Prediction** (Estimate token usage before run) | 4 | 3 | üî¥ Todo |
| **P1** | **Agent Replay** (Retry task with different model) | 4 | 3 | üî¥ Todo |
| **P2** | **Agent Trust Score** (Confidence based on history) | 4 | 2 | üî¥ Todo |
| **P2** | **XP & Badges** (Gamification per project) | 3 | 2 | üî¥ Todo |
| **P3** | **Keyboard Shortcuts** (Quick nav J/K/L) | 3 | 1 | üî¥ Todo |
| **P4** | **Dark/Light Theme** (Toggle switch) | 2 | 1 | üî¥ Todo |

**Directives for Future Agents:**
1. Consult this table before starting new "Phase 16" tasks.
2. Update status (üî¥ -> üü° -> ‚úÖ) here AND in `task.md`.
3. Do not delete this section without user approval.

